<!DOCTYPE html>
<html lang="en">

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.8.0/chart.min.js"
        integrity="sha512-sW/w8s4RWTdFFSduOTGtk4isV1+190E/GghVffMA9XczdJ2MDzSzLEubKAs5h0wzgSJOQTRYyaz73L3d6RtJSg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<p>Student ID: 89800</p>
<p>Name: Xuewei Niu</p>

{% if msg %}
<p>{{ msg }}</p>
{% endif %}

{% if attachment['task_name'] == 'task_1' %}
<h1>Task 1</h1>
<div style="width: 40%; margin: auto">
    <canvas id="task_1_pie_chart"></canvas>
</div>
{% endif %}

{% if attachment['task_name'] == 'task_2' %}
<h1>Task 2</h1>
<div style="width: 40%; margin: auto">
    <canvas id="task_2_bar_chart"></canvas>
</div>
{% endif %}

{% if attachment['task_name'] == 'task_3' %}
<h1>Task 3</h1>
<div style="width: 40%; margin: auto">
    <canvas id="task_3_scatter_chart"></canvas>
</div>
{% endif %}

<script>
    let labels = [];
    let dataset = [];

    {% if attachment['task_name'] == 'task_1' %}
    {% for i in data %}
    labels.push('{{ i['fruit'] }}')
    dataset.push({{ i['cnt'] }})
    {% endfor %}

    console.log(labels)
    console.log(dataset)


    let task_1_pie_chart_ctx = document.getElementById('task_1_pie_chart').getContext('2d');
    let task_1_pie_chart = new Chart(task_1_pie_chart_ctx, {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                label: labels,
                data: dataset,
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                ],
                borderColor: [
                    'rgba(255,99,132,1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                ],
                borderWidth: 1
            }]
        }
    });
    {% endif %}

    {% if attachment['task_name'] == 'task_2' %}
    let backgroundColor = [];
    let borderColor = [];
    {% for i in data %}
    labels.push('{{ i['fruit'] }}')
    dataset.push({{ i['cnt'] }})
    backgroundColor.push('rgba(124,252,0,1)')
    borderColor.push('rgba(0,128,0,1)')
    {% endfor %}

    console.log(labels)
    console.log(dataset)


    let task_2_bar_chart_ctx = document.getElementById('task_2_bar_chart').getContext('2d');
    let task_2_bar_chart = new Chart(task_2_bar_chart_ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'dataset 1',
                data: dataset,
                backgroundColor: backgroundColor,
                borderColor: borderColor,
                borderWidth: 1
            }]
        }
    });
    {% endif %}

    {% if attachment['task_name'] == 'task_3' %}
    {% for i in data %}
    dataset.push({
        x: {{ i['col_1'] }},
        y: {{ i['col_3'] }},
    })
    {% endfor %}
    console.log(dataset)

    let task_3_scatter_chart_ctx = document.getElementById('task_3_scatter_chart').getContext('2d');
    let task_3_scatter_chart = new Chart(task_3_scatter_chart_ctx, {
        type: 'scatter',
        data: {
            datasets: [{
                borderColor: 'rgba(255,99,132,1)',
                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                label: 'task 3',
                data: dataset
            }]
        },
        options: {
            scales: {
                x: {
                    type: 'linear',
                    position: 'bottom',
                    title: {
                        text: 'col_1',
                        display: true,
                    }
                },
                y: {
                    title: {
                        text: 'col_3',
                        display: true,
                    }
                }
            }
        },
    })
    {% endif %}
</script>

</html>